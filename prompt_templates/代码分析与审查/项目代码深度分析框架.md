## 总真实需求
```
输入：一个代码项目（多个文件）
     ↓
    AI分析
     ↓
输出：N+1 个 Markdown 分析文档
     ├─ 文件1.md（详尽分析文件1的所有细节）
     ├─ 文件2.md（详尽分析文件2的所有细节）
     ├─ 文件3.md（详尽分析文件3的所有细节）
     └─ PROJECT_SUMMARY.md（整个项目的宏观分析）

这些MD文档 = 详细的分析资料库
后续用途：写报告时查阅、理解代码、答辩准备等
```

---

# 📝 提示词设计框架

## 🎨 设计考虑的核心维度

### 1️⃣ **输入信息的组织**
```yaml
需要从用户获取:
  - 项目整体信息（技术栈、目的、结构）
  - 每个文件的代码内容
  - 文件间的关联关系
  - 特殊关注点/已知问题
```

### 2️⃣ **输出结构的明确**
```yaml
明确告诉AI:
  - 需要输出几个MD文件
  - 每个MD文件的命名规则
  - 每个MD文件的详细程度标准
  - 文件间的分隔标识
```

### 3️⃣ **单文件分析的详尽度标准**
```yaml
对每个代码文件必须分析:
  基础层:
    - 文件元信息（路径、大小、编码等）
    - 导入依赖（import/include清单）
    - 整体功能概述

  结构层:
    - 所有类/函数/变量的清单
    - 代码块的层级结构
    - 注释分布情况

  细节层:
    - 每个函数的详细剖析（参数、返回值、逻辑）
    - 每个类的详细剖析（属性、方法、继承）
    - 关键算法的逐行解释
    - 数据结构的详细说明

  关联层:
    - 调用了哪些外部函数/类
    - 被哪些文件调用
    - 数据流入流出

  质量层:
    - 代码规范评估
    - 潜在问题识别
    - 复杂度分析
```

### 4️⃣ **项目总结分析的维度**
```yaml
PROJECT_SUMMARY.md应包含:
  - 项目架构总览
  - 文件依赖关系图
  - 核心执行流程
  - 技术栈分析
  - 设计模式识别
  - 数据流分析
  - 关键技术点汇总
  - 整体代码质量评估
  - 项目特点与亮点
```

### 5️⃣ **准确性保障机制**
```yaml
防止AI出错的措施:
  - 禁止推测：不确定的必须标注
  - 禁止省略：即使代码简单也要详细分析
  - 禁止泛泛而谈：必须有具体行号和代码引用
  - 要求自检：输出前检查完整性
  - 分步确认：先输出分析计划再执行
```

### 6️⃣ **格式规范与一致性**
```yaml
统一的Markdown规范:
  - 标题层级规则
  - 代码块格式（语言标注、行号）
  - 表格格式（参数说明、函数清单等）
  - 特殊标记（重要、警告、疑问）
  - 交叉引用格式
```

### 7️⃣ **可追溯性**
```yaml
每条分析必须能追溯到代码:
  - 引用代码时标注行号
  - 使用代码片段展示
  - 明确指出分析依据
```

### 8️⃣ **分批处理策略**（如果项目很大）
```yaml
可选方案:
  方案A: 一次性提交所有代码，AI分批输出
  方案B: 分文件提交，逐个生成分析MD
  方案C: 先生成项目总结，再逐个深入
```

---





# 📄 完整提示词模板

```markdown
# 🎯 任务定义

你是一位专业的代码分析专家。你的任务是对提供的代码项目进行**深度分析**，并生成**多个独立的Markdown分析文档**。

## 核心要求
1. **详尽性**：分析必须详细到每个函数、每个类、每个关键逻辑
2. **准确性**：所有描述必须准确，不得推测，不确定的内容标注`[待确认]`
3. **独立性**：每个代码文件生成一个独立的MD文档
4. **完整性**：不得省略任何文件，不得简化分析

## 输出目标
生成 **N+1** 个Markdown文件：
- `[文件名]_analysis.md` × N个（每个代码文件一个）
- `PROJECT_SUMMARY.md` × 1个（项目整体分析）

---

# 📥 项目信息输入区

## 项目基础信息
```yaml
项目名称: [填写]
项目类型: [Web应用/算法实现/数据分析/桌面应用/etc]
主要语言: [Python/Java/C++/JavaScript/etc]
语言版本: [Python 3.9/Java 11/etc]
依赖框架: [Flask/Spring/React/无/etc]
开发环境: [操作系统、IDE等]
项目规模: [X个文件]
```

## 项目目录结构
```
[粘贴完整目录树，示例:]
project/
├── main.py              # 程序入口
├── core/
│   ├── engine.py        # 核心引擎
│   └── utils.py         # 工具函数
├── config/
│   └── settings.py      # 配置管理
├── data/
│   └── data.json        # 数据文件
└── README.md
```

## 文件依赖关系（已知）
```
[描述文件间调用关系，示例:]
main.py → engine.py → utils.py
main.py → settings.py
engine.py → data.json
```

## 特殊说明
```
[任何需要AI特别注意的点:]
- 重点关注: XXX算法的实现
- 已知问题: XXX函数可能有bug
- 疑问点: XXX部分不确定是否正确
```

---

# 📤 代码文件提交区（已提交至附件）

**分析要求（被标注则需要实现）**:
- [x] 基础分析（导入、结构、概述）
- [x] 详细分析（每个函数/类）
- [x] 算法分析（关键逻辑）
- [x] 关联分析（与其他文件交互）
- [ ] 质量分析（规范、问题）

---

# 📋 输出格式规范

## 🔹 单文件分析MD的标准结构

每个 `[文件名]_analysis.md` 必须包含以下章节：

```markdown
# [文件名] 详细分析

## 📄 文件元信息
| 属性 | 值 |
|------|-----|
| 文件路径 | `xxx` |
| 文件大小 | XXX 行 |
| 主要作用 | XXX |
| 复杂度等级 | 低/中/高 |

---

## 📦 导入依赖分析

### 标准库导入
| 模块名 | 用途 | 使用位置 |
|--------|------|----------|
| os     | 文件操作 | 第23行, 第45行 |

### 第三方库导入
| 模块名 | 版本要求 | 用途 | 使用位置 |
|--------|----------|------|----------|
| numpy  | ≥1.19    | 数组计算 | 第67行 |

### 项目内部导入
| 模块名 | 导入内容 | 用途 | 对应文件 |
|--------|----------|------|----------|
| utils  | format_date() | 日期格式化 | utils.py |
```
---

## 🏗️ 代码结构总览
```
### 整体结构

[用树状图或列表展示代码结构]
文件整体
├── 导入区 (第1-10行)
├── 常量定义 (第12-20行)
├── 类定义
│   ├── ClassA (第25-80行)
│   └── ClassB (第85-150行)
└── 主函数 (第155-200行)

---

## 🔍 详细分析

### 全局变量/常量

#### 1. `VARIABLE_NAME`
- **定义位置**: 第X行
- **数据类型**: [类型]
- **初始值**: [值]
- **作用**: [详细说明]
- **使用位置**: 第A行, 第B行, ...

---

### 类详细分析

#### 类1: `ClassName`

##### 基本信息
- **定义位置**: 第X-Y行
- **继承关系**: 继承自 `ParentClass` / 无继承
- **实现接口**: [如果有]
- **核心职责**: [详细说明这个类的作用]

##### 类属性
| 属性名 | 类型 | 访问权限 | 默认值 | 说明 |
|--------|------|----------|--------|------|
| attr1  | str  | private  | None   | XXX  |

##### 方法清单
| 方法名 | 类型 | 参数 | 返回值 | 作用 |
|--------|------|------|--------|------|
| __init__() | 构造 | self, name | None | 初始化 |
| method1() | 实例 | self, x | int | 计算XXX |
| method2() | 静态 | data | bool | 验证XXX |

##### 方法详细分析

###### 方法: `__init__(self, param1, param2)`
**定义位置**: 第X-Y行

**功能说明**: [详细描述]

**参数详解**:
| 参数名 | 类型 | 必需 | 默认值 | 说明 |
|--------|------|------|--------|------|
| param1 | str  | 是   | -      | XXX  |
| param2 | int  | 否   | 0      | XXX  |

**返回值**: None

**执行流程**:
1. 第X行：验证参数有效性
2. 第X+1行：初始化内部状态
3. 第X+2行：...

**关键代码片段**:
```python
# 第X-Y行
def __init__(self, param1, param2=0):
    if not isinstance(param1, str):  # 参数验证
        raise TypeError("param1 must be string")
    self.param1 = param1
    self.param2 = param2
```

**调用示例**:
```python
obj = ClassName("test", 10)
```

**被调用位置**:
- 本文件第Z行
- [其他文件]的第M行

**异常处理**:
- `TypeError`: 参数类型错误时抛出
- [其他异常]

**复杂度分析**:
- 时间复杂度: O(1)
- 空间复杂度: O(1)

---

###### 方法: `method1(self, x)`
[重复上述详细结构...]

---

### 独立函数详细分析

#### 函数: `function_name(param1, param2)`

**定义位置**: 第X-Y行

**功能说明**: [详细描述]

**参数详解**:
[同上]

**返回值详解**:
- **类型**: [类型]
- **含义**: [说明]
- **可能的返回情况**:
  - 情况1: 返回XXX，当...
  - 情况2: 返回XXX，当...

**算法逻辑**:
1. **第一步**（第X行）: [详细说明]
   ```python
   [代码片段]
   ```
   - 作用: ...
   - 注意: ...

2. **第二步**（第Y行）: [详细说明]
   [...]

**完整代码**:
```python
[函数完整代码，带行号]
```

**算法分析**:
- **算法类型**: [如：排序/搜索/动态规划/etc]
- **时间复杂度**: O(?)，推导过程: ...
- **空间复杂度**: O(?)，推导过程: ...
- **最优情况**: ...
- **最坏情况**: ...

**调用关系**:
- **内部调用**: 调用了本文件的`xxx()`函数（第M行）
- **外部调用**: 调用了`module.xxx()`（第N行）
- **被调用**: 被本文件第P行调用，被`other_file.py`第Q行调用

**测试建议**:
- 测试用例1: 输入 → 预期输出
- 边界情况: ...
- 异常情况: ...

---

## 🔗 文件关联分析

### 对外依赖（本文件使用了哪些外部资源）
| 外部文件/模块 | 使用内容 | 使用位置 | 用途 |
|--------------|----------|----------|------|
| utils.py     | helper() | 第50行   | 辅助计算 |

### 被依赖情况（哪些文件使用了本文件）
| 调用文件 | 使用内容 | 调用位置 | 用途 |
|---------|----------|----------|------|
| main.py | ClassA   | 第30行   | 创建实例 |

### 数据流分析
```
输入 → [本文件处理] → 输出
  ↓
详细说明数据如何流入、处理、流出
```

---

## 💡 关键技术点

### 技术点1: [名称]
- **位置**: 第X-Y行
- **技术说明**: [详细解释]
- **应用场景**: [为什么这里用这个技术]
- **代码示例**:
  ```python
  [相关代码]
  ```

### 算法要点: [名称]
- **算法原理**: [详细说明]
- **实现细节**: [具体怎么实现的]
- **优化手段**: [如果有]

---

## 📊 代码质量评估

### 代码规范
- **命名规范**: ✅ 符合 / ⚠️ 部分不符 / ❌ 不符
  - 具体问题: [列出]
- **注释完整性**: [评分] - [说明]
- **代码缩进**: [评估]
- **PEP 8 / 语言规范**: [符合程度]

### 潜在问题
| 问题类型 | 位置  | 问题描述 | 严重程度 | 建议  |
| ---- | --- | ---- | ---- | --- |
| 逻辑错误 | 第X行 | XXX  | 高    | XXX |
| 性能问题 | 第Y行 | XXX  | 中    | XXX |

### 代码优点
- ✅ 优点1: [具体说明]
- ✅ 优点2: [具体说明]

### 改进建议
- 📌 建议1: [具体说明]
- 📌 建议2: [具体说明]

---

## 🔖 特殊标注

### 需要确认的内容
- ❓ [不确定的地方，需要开发者确认]

### 重要提示
- ⚠️ [需要特别注意的地方]

### TODO/FIXME 提取
- 📝 TODO (第X行): [内容]
- 🐛 FIXME (第Y行): [内容]

---

## 📎 附录

### 相关资源
- 依赖的外部文档: [如果有]
- 参考算法: [如果有]

---

## 🔹 项目总结MD的标准结构

`PROJECT_SUMMARY.md` 必须包含：

```markdown
# 项目整体分析报告

## 📊 项目概览

### 基本信息
| 项目属性 | 详情 |
|---------|------|
| 项目名称 | XXX |
| 项目类型 | XXX |
| 主要语言 | XXX |
| 文件数量 | XXX个 |
| 核心功能 | XXX |

### 项目目录结构
```
[完整的目录树，带说明]
```

---

## 🏛️ 架构分析

### 整体架构
[用文字+图表描述项目架构]

```
[可以用Mermaid语法画架构图]
graph TD
    A[入口] --> B[核心模块]
    B --> C[工具模块]
```

### 架构模式
- **设计模式**: [识别出的设计模式]
- **架构风格**: [MVC/分层/微服务/etc]
- **模块化程度**: [评估]

---

## 📁 文件清单与职责

| 文件名 | 路径 | 行数 | 核心职责 | 复杂度 | 重要性 |
|--------|------|------|----------|--------|--------|
| main.py | / | 200 | 程序入口 | 低 | ⭐⭐⭐ |
| engine.py | /core | 500 | 核心算法 | 高 | ⭐⭐⭐⭐⭐ |

---

## 🔗 依赖关系分析

### 文件依赖图
```mermaid
[用Mermaid画依赖关系图]
```

### 依赖矩阵
| 文件      | 依赖的文件               | 被依赖次数 |
| ------- | ------------------- | ----- |
| main.py | engine.py, utils.py | 0     |

### 核心依赖链
```
入口 → 核心 → 工具
[详细说明关键调用链路]
```

---

## 🔄 执行流程分析

### 主流程
```
启动 → 初始化 → 主循环 → 清理 → 退出
[详细说明每个阶段]
```

### 关键流程图
```mermaid
[用流程图展示核心业务逻辑]
```

### 数据流向
```
输入数据 → 处理模块A → 处理模块B → 输出结果
[详细追踪数据在各模块间的流动]
```

---

## 🛠️ 技术栈分析

### 核心技术
| 技术/库 | 版本  | 用途   | 使用文件   |
| ---- | --- | ---- | ------ |
| [库名] | X.Y | [用途] | [文件列表] |

### 算法汇总
| 算法名称 | 实现位置 | 复杂度 | 用途 |
|---------|----------|--------|------|
| [算法] | file.py:100 | O(n) | [用途] |

### 数据结构汇总
| 数据结构 | 定义位置 | 用途 | 复杂度分析 |
|---------|----------|------|-----------|
| [结构] | file.py:50 | [用途] | [分析] |

---

## 💎 核心功能模块

### 模块1: [名称]
- **组成文件**: [列表]
- **核心功能**: [详细说明]
- **关键实现**: [技术要点]
- **交互关系**: [与其他模块的关系]

### 模块2: [名称]
[重复上述结构]

---

## 🎯 关键技术亮点

### 亮点1: [名称]
- **位置**: [文件:行号]
- **技术说明**: [详细解释]
- **优势**: [为什么这样设计]

---

## 📈 代码质量总评

### 整体评分
| 评估维度 | 得分 | 说明 |
|---------|------|------|
| 代码规范 | 8/10 | [具体说明] |
| 可读性 | 7/10 | [具体说明] |
| 可维护性 | 8/10 | [具体说明] |
| 性能 | 7/10 | [具体说明] |
| 安全性 | 6/10 | [具体说明] |

### 优势总结
- ✅ [优势1]
- ✅ [优势2]

### 问题汇总
| 问题类型 | 数量  | 严重程度 | 主要问题 |
| ---- | --- | ---- | ---- |
| 逻辑错误 | 2   | 高    | [列举] |
| 性能问题 | 5   | 中    | [列举] |


---

## 🎓 技术要点提取

[按主题提取项目中的关键技术知识点，便于学习]

### 知识点1: [名称]
- **相关代码**: [文件:行号]
- **知识说明**: [详细解释]
- **应用场景**: [为什么用]

---
**项目文件总数**: N个
**生成文档总数**: N+1个
```

---

# ⚙️ AI 执行流程

## 阶段0: 接收与确认（必须先输出）
```markdown
## 📥 任务接收确认

### 接收到的文件清单
- [x] FILE_001: main.py (200行)
- [x] FILE_002: engine.py (500行)
- [x] FILE_00N: ...
**总计**: N个文件

### 将生成的文档清单
- [ ] main_analysis.md
- [ ] engine_analysis.md
- [ ] ...
- [ ] PROJECT_SUMMARY.md
**总计**: N+1个文档

### 分析计划
1. 第一步: 逐个分析各文件，生成独立MD
2. 第二步: 综合分析，生成项目总结MD
3. 第三步: 交叉检查，确保完整性

### 预估分析时间
- 单文件平均: [估算]
- 总计: [估算]

### 确认理解
- [x] 理解任务要求: 生成N+1个独立MD文档
- [x] 理解详尽度要求: 每个函数/类都要详细分析
- [x] 理解输出格式: 严格按照模板结构
- [x] 不确定内容会标注 [待确认]

### 特殊关注点确认
[复述用户提到的特殊要求]

---

**准备开始分析，请确认以上信息无误**
```

## 阶段1: 逐文件深度分析
- 按 FILE_001, FILE_002... 的顺序
- 每个文件严格按照单文件分析模板
- 每个函数/类都详细剖析
- 输出时明确标注文档分隔

## 阶段2: 项目整体分析
- 综合所有文件信息
- 构建依赖关系
- 提取核心流程
- 按项目总结模板输出

## 阶段3: 完整性自检
```markdown
## ✅ 分析完整性自检报告

### 文件覆盖检查
- [x] main.py: 已生成 main_analysis.md
  - [x] 全局变量: 3个，已全部分析
  - [x] 类: 0个
  - [x] 函数: 5个，已全部详细分析
  - [x] 依赖关系: 已梳理
  - [x] 质量评估: 已完成

- [x] engine.py: 已生成 engine_analysis.md
  - [x] 类: 2个，已全部详细分析
  - [x] 函数: 8个，已全部详细分析
  - [...]

### 项目总结检查
- [x] 架构分析: 完成
- [x] 依赖关系图: 完成
- [x] 技术栈汇总: 完成
- [x] 执行流程: 完成
- [x] 质量评估: 完成

### 质量检查
- [x] 所有代码片段都有行号标注
- [x] 所有函数都有参数和返回值说明
- [x] 所有不确定内容都标注了 [待确认]
- [x] Markdown格式符合规范
- [x] 交叉引用链接正确

### 输出统计
- 生成文档数: N+1个 ✅
- 总字数: [统计]
- 代码片段数: [统计]
- 图表数: [统计]

**分析完成，可交付使用**
```

---

# 🎮 输出控制指令

## 明确分隔标识
为了让用户能够清晰区分每个MD文档，使用以下分隔格式：

```markdown
═══════════════════════════════════════════════════
📄 文档开始: main_analysis.md
═══════════════════════════════════════════════════

[文档内容]

═══════════════════════════════════════════════════
📄 文档结束: main_analysis.md
═══════════════════════════════════════════════════


═══════════════════════════════════════════════════
📄 文档开始: engine_analysis.md
═══════════════════════════════════════════════════

[文档内容]

═══════════════════════════════════════════════════
📄 文档结束: engine_analysis.md
═══════════════════════════════════════════════════
```

## 长度控制策略
如果单个文件分析非常长，提供选项：
- **选项A**: 分段输出，用户说"继续"后接着输出
- **选项B**: 先输出概要，用户确认后输出详细版
- **选项C**: 一次性完整输出（默认）

---

# 🔒 质量保证规则

## 必须遵守的铁律
1. ❗ **不得省略**: 即使函数很简单，也必须按模板分析
2. ❗ **不得推测**: 不确定的必须写 `[待确认: 原因]`
3. ❗ **必须追溯**: 每个结论都要标注代码位置（行号）
4. ❗ **必须完整**: 所有类的所有方法都要分析
5. ❗ **必须准确**: 函数参数、返回值必须准确描述

## 标准化用语
- ✅ 使用: "该函数接收2个参数..."
- ❌ 避免: "这个函数好像有几个参数..."

- ✅ 使用: "第50-60行实现了快速排序算法"
- ❌ 避免: "这里用了排序"

## 不确定内容的处理
```markdown
### ❓ 不确定分析

#### 疑问1: [具体描述疑问]
- **位置**: 第X行
- **代码**: `[代码片段]`
- **疑问**: [为什么不确定]
- **可能的解释**:
  - 解释A: [详细说明]
  - 解释B: [详细说明]
- **建议**: [需要开发者确认/查阅文档/etc]
```

---

# 💡 高级选项（可选）

## 选项1: 生成代码调用图

是否需要为每个文件生成详细的函数调用关系图？
- [x] 是（使用Mermaid语法）
- [ ] 否

## 选项2: 生成类继承图

是否需要生成UML类图？
- [ ] 是
- [x] 否


## 选项3: 算法可视化

是否需要对关键算法进行步骤可视化？
- [x] 是
- [ ] 否


## 选项4: 性能分析

是否需要深度性能分析（瓶颈识别、优化建议）？
- [x] 是（会增加分析时间）
- [ ] 否


---

# 📦 打包交付格式

分析完成后，提供目录索引：

```markdown
# 📚 分析文档交付清单

## 文件分析文档
1. [main_analysis.md](#) - 主程序入口分析（3500字）
2. [engine_analysis.md](#) - 核心引擎分析（8000字）
3. [utils_analysis.md](#) - 工具模块分析（2000字）
...

## 项目总结文档
1. [PROJECT_SUMMARY.md](#) - 项目整体分析（5000字）

## 附加资源（如有）
1. [architecture_diagram.md](#) - 架构图
2. [function_index.md](#) - 函数索引

---

**总字数**: XXX
**总文档数**: N+1
**生成时间**: [时间]
```

---

# 🎯 使用示例

## 用户填写示例
````markdown
# 项目基础信息
```yaml
项目名称: 学生成绩管理系统
项目类型: 桌面应用
主要语言: Python
语言版本: Python 3.9
依赖框架: tkinter (GUI), sqlite3 (数据库)
项目规模: 5个文件，约800行代码
```

# 项目目录结构
```
StudentManager/
├── main.py           # GUI主界面
├── database.py       # 数据库操作
├── student.py        # 学生类定义
├── utils.py          # 工具函数
└── config.py         # 配置文件
```

# 代码文件

### FILE_001: main.py
```yaml
文件路径: main.py
文件作用: 程序入口，创建GUI界面
代码行数: 250
```

**完整代码**:
```python
import tkinter as tk
from database import Database
from student import Student

class MainWindow:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("学生成绩管理系统")
        self.db = Database()
        self.create_widgets()

    # ... [完整代码]
```

### FILE_002: database.py
[继续...]
````
```